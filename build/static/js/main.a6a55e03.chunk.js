(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,n){e.exports=n(20)},16:function(e,t,n){},18:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(9),s=n.n(i),u=(n(16),n(2)),o=n(1),c=n(3),l=n(4),m=n(6),h=n(5),d=n(7),g=(n(18),{NORMAL:1,FEARSOME:2,TERRIFYING:3}),f={EMPTY:"empty",CLOSE:"close",RANGE:"range",HOLD:"hold",DISRUPTED:"disrupted",ROUT:"rout",DEAD:"dead"},p={rollDie:function(){return Math.floor(6*Math.random())+1}},_={getCourage:function(e){var t=e.courage;return null!=e.temp_courage_mod&&(t+=e.temp_courage_mod),this.inTheYellow(e)?t-1:this.inTheRed(e)?t-2:void 0},isDead:function(e){return 0===e.life_boxes.reduce(function(e,t){return e+t},0)},isDeadOrRouting:function(e){return _.isDead(e)||e.order===f.ROUT},applyDamage:function(e,t){var n=e.life_boxes,a=!1,r=e.order;if(t>0)for(var i=0;i<3;i++)if(e.life_boxes[i]>0){var s=Math.min(e.life_boxes[i],t);s>0&&2===i&&(e.needs_rout_check=!0),n[i]=e.life_boxes[i]-s,t-=s,0===n[i]&&(2===i&&(r=f.DEAD),a=!0)}return Object(o.a)({},e,{life_boxes:n,needs_rout_check:a,order:r})},inTheRed:function(e){return 0===e.life_boxes[0]&&0===e.life_boxes[1]},inTheYellow:function(e){return 0===e.life_boxes[0]&&e.life_boxes[1]>0},getDice:function(e,t){var n=e.dice;return this.inTheYellow(e)&&(n-=1),this.inTheRed(e)&&(n-=2),t&&(n+=e.charging_dice_mod),Math.max(0,n)},getAttackStat:function(e,t){return t?Math.max(0,e.attack+e.charging_attack_mod):e.attack},getPowerStat:function(e,t){return t?Math.max(0,e.power+e.charging_power_mod):e.power},getDefenseStat:function(e,t){return t?Math.max(0,e.defense+e.charging_defense_mod):e.defense},getToughnessStat:function(e,t){return t?Math.max(e.toughness+e.charging_toughness_mod):e.toughness},getImpactHits:function(e,t){return t?e.impact_hits:0}},v=_,w={resolveFearCheck:function(e,t){return t.fear_level===g.TERRIFYING&&e.fear_level===g.NORMAL?Object(o.a)({},e,{temp_courage_mod:-1}):e},resolveRoutCheck:function(e){return e.needs_rout_check?this.rollCourage()>v.getCourage(e)?Object(o.a)({},e,{order:f.ROUT}):Object(o.a)({},e,{needs_rout_check:!1}):e},rollCourage:function(){return p.rollDie()+p.rollDie()+p.rollDie()}},b={canAttack:function(e,t){return e.range<=t},calculateDamage:function(e,t,n){var a=this.makeAttackStat(e,n),r=this.makeDefenseStat(t);return this.rollAttack(a,r)},makeAttackStat:function(e,t){return{dice:v.getDice(e,t),impact_hits:v.getImpactHits(e,t),attack:v.getAttackStat(e,t),power:v.getPowerStat(e,t)}},makeDefenseStat:function(e,t){return{defense:v.getDefenseStat(e,t),toughness:v.getToughnessStat(e,t)}},rollAttack:function(e,t){for(var n=0,a=0;a<e.dice;a++){var r=p.rollDie();1===r?n++:r<=e.attack-t.defense&&n++}n+=e.impact_hits;for(var i=0,s=0;s<n;s++){var u=p.rollDie();1===u?i++:u<=e.power-t.toughness&&i++}return i}},k={winsPerUnit:function(e,t){return e.reduce(function(e,n){return e+(n.winner===t?1:0)},0)}},D={simulateMany:function(e,t,n){for(var a=[],r=0;r<n;r++){var i=this.simulateGame(e,t);a.push(i)}var s=k.winsPerUnit(a,e.name),u=k.winsPerUnit(a,t.name),o=k.winsPerUnit(a,"draw");return{unit1_wins:s,unit1_wins_percent:100*s/n,unit2_wins:u,unit2_wins_percent:100*u/n,draws:o,draws_percent:100*o/n}},simulateGame:function(e,t){for(var n=.25,a=0,r=this.parseUnit(e),i=this.parseUnit(t);a<200;){a+=1;var s=this.simulateTurn(r,i,n);if(v.isDeadOrRouting(s.activeUnit)&&v.isDeadOrRouting(s.passiveUnit))return{turns:a,winner:"draw",loser_order:s.activeUnit.order};if(v.isDeadOrRouting(s.activeUnit))return{turns:a,winner:i.name,loser_order:s.activeUnit.order};if(v.isDeadOrRouting(s.passiveUnit))return{turns:a,winner:r.name,loser_order:s.passiveUnit.order};r=s.passiveUnit,i=s.activeUnit,n=s.distance}return{turns:a,winner:"not sure"}},simulateTurn:function(e,t,n){var a=!1,r=n;n>0&&(r=Math.max(0,n-e.speed))<.1&&(a=!0);var i=this.resolveCombatPhase(e,t,a,n);return{activeUnit:i.activeUnit,passiveUnit:i.passiveUnit,distance:r}},resolveCombatPhase:function(e,t,n,a){if(n&&(e=w.resolveFearCheck(e,t),t=w.resolveFearCheck(t,e)),b.canAttack(e,a)){var r=b.calculateDamage(e,t,n);t=v.applyDamage(t,r)}if(b.canAttack(t,a)){var i=b.calculateDamage(t,e,n);e=v.applyDamage(e,i)}return{activeUnit:e=w.resolveRoutCheck(e),passiveUnit:t=w.resolveRoutCheck(t)}},parseUnit:function(e){return Object(o.a)({},e,{life_boxes:[Number(e.green),Number(e.yellow),Number(e.red)]})}},O=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(n=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).handleInputChange=function(e){var t=e.currentTarget,a=t.value,r=t.name,i=a;"name"!==r&&""!==i&&"-"!==i&&(i=Number(a)?Number(a):0);var s=Object(o.a)({},n.props.values,Object(u.a)({},r,i));n.props.onChange(n.props.unitKey,s)},n.renderInputs=function(){return Object.keys(n.props.values).map(n.renderInput)},n.renderInput=function(e){return r.a.createElement("div",{key:e},r.a.createElement("label",null,e," ",r.a.createElement("input",{type:"text",value:n.props.values[e],name:e,onChange:n.handleInputChange})))},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",null,this.props.unitKey),this.renderInputs())}}]),t}(r.a.Component),E=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(m.a)(this,Object(h.a)(t).call(this))).handleSimulateClick=function(){var t=D.simulateMany(e.state.unit1,e.state.unit2,e.state.numGames);e.setState({results:t})},e.handleUnitPropertyValueChange=function(t,n){e.setState(Object(u.a)({},t,n))},e.handleNumGamesChange=function(t){var n=t.currentTarget.value,a=Number(n)?Number(n):0;e.setState({numGames:a})},e.renderUnit=function(t,n){return r.a.createElement(O,{values:t,unitKey:n,onChange:e.handleUnitPropertyValueChange})},e.state={results:{turns:0,winner:"press button to start simulation"},numGames:1,unit1:{name:"Phalanx",green:6,yellow:2,red:2,dice:5,attack:7,power:5,defense:2,toughness:2,courage:12,range:0,speed:3.5,fear_level:1,charging_dice_mod:2,charging_attack_mod:1,charging_power_mod:-1,charging_defense_mod:-1,charging_toughness_mod:2,impact_hits:1},unit2:{name:"Orc Axemen",green:5,yellow:3,red:2,dice:5,attack:6,power:6,defense:1,toughness:3,courage:13,range:0,speed:3.5,fear_level:1,charging_dice_mod:0,charging_attack_mod:0,charging_power_mod:0,charging_defense_mod:0,charging_toughness_mod:0,impact_hits:0}},e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"Battle simulator"),r.a.createElement("div",null,r.a.createElement("label",null,"Number of games:",r.a.createElement("input",{type:"text",value:this.state.numGames,name:"numGames",onChange:this.handleNumGamesChange}))),r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"half-page-box"},this.renderUnit(this.state.unit1,"unit1")),r.a.createElement("div",{className:"half-page-box"},this.renderUnit(this.state.unit2,"unit2"))),r.a.createElement("button",{className:"myButton",onClick:this.handleSimulateClick},"Simulate"),r.a.createElement("h2",null,"Simulation results"),r.a.createElement("div",null,this.state.unit1.name," wins: ",this.state.results.unit1_wins,"(",this.state.results.unit1_wins_percent,"%)"),r.a.createElement("div",null," ",this.state.unit2.name," wins: ",this.state.results.unit2_wins,"(",this.state.results.unit2_wins_percent,"%)"),r.a.createElement("div",null,"Draws: ",this.state.results.draws,"(",this.state.results.draws_percent,"%)"))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[10,2,1]]]);
//# sourceMappingURL=main.a6a55e03.chunk.js.map